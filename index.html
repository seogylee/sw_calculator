<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>스윙 웨이트 계산기 - 피클볼 패들</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; }
        .faq-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
        .faq-content.open { max-height: 200px; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen p-4 sm:p-6 lg:p-10">

    <div class="max-w-6xl mx-auto">

        <!-- Header Section -->
        <div class="flex flex-col lg:flex-row justify-between items-start gap-4 sm:gap-6 mb-6 sm:mb-8">
            <div>
                <h1 class="text-2xl sm:text-3xl lg:text-4xl font-extrabold text-gray-800 mb-2 sm:mb-3">스윙 웨이트 계산기</h1>
                <p class="text-gray-600 text-sm sm:text-base lg:text-lg">
                    피클볼 패들의 스윙 웨이트를
                    <span class="text-yellow-600 font-semibold">정적 무게</span>,
                    <span class="text-yellow-600 font-semibold">밸런스 포인트</span>,
                    <span class="text-yellow-600 font-semibold">길이</span>로
                    추정하는 도구입니다.
                </p>
            </div>

            <!-- Quick Reference Box -->
            <div class="bg-yellow-50 border-2 border-yellow-200 rounded-xl p-4 sm:p-5 w-full lg:w-auto lg:min-w-[280px]">
                <div class="flex gap-6 sm:gap-8">
                    <div>
                        <h3 class="text-blue-600 font-bold text-xs sm:text-sm mb-2">입력값</h3>
                        <ul class="text-gray-700 text-xs sm:text-sm space-y-1">
                            <li>무게 <span class="text-gray-400">(oz/g)</span></li>
                            <li>밸런스 <span class="text-gray-400">(cm)</span></li>
                            <li>길이 <span class="text-gray-400">(in/cm)</span></li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="text-blue-600 font-bold text-xs sm:text-sm mb-2">출력값</h3>
                        <p class="text-gray-700 text-xs sm:text-sm font-semibold">예상 스윙 웨이트</p>
                        <p class="text-gray-500 text-xs sm:text-sm">kg·cm² 단위</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section Title -->
        <div class="mb-4 sm:mb-6">
            <h2 class="text-xl sm:text-2xl font-bold text-gray-800">메인 계산기</h2>
            <p class="text-gray-500 text-sm sm:text-base">패들 스펙을 입력하여 스윙 웨이트를 계산하세요.</p>
        </div>

        <!-- Main Content Grid -->
        <div class="grid lg:grid-cols-2 gap-6 sm:gap-8">

            <!-- Left: Calculator Card -->
            <div class="bg-white rounded-2xl border border-gray-200 shadow-sm p-5 sm:p-8">

                <!-- Paddle Preset -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <span class="mr-2">🏓</span>인기 패들 프리셋
                    </label>
                    <select id="paddle-preset" onchange="applyPreset()"
                        class="w-full p-3 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-blue-500 outline-none text-sm sm:text-base">
                        <option value="">패들을 선택하세요...</option>
                        <option value="joola">Joola Ben Johns Hyperion CFS 16</option>
                        <option value="selkirk">Selkirk Vanguard Power Air</option>
                        <option value="crbn">CRBN 1X Power Series</option>
                        <option value="engage">Engage Pursuit Pro MX 6.0</option>
                        <option value="franklin">Franklin Ben Johns 13mm</option>
                        <option value="custom">직접 입력</option>
                    </select>
                </div>

                <hr class="mb-6 border-gray-200">

                <h3 class="text-base sm:text-lg font-bold text-gray-800 mb-4 sm:mb-6">패들 스펙 입력</h3>

                <!-- Input: Static Weight -->
                <div class="mb-5 sm:mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">정적 무게</label>
                    <div class="flex gap-2">
                        <input type="number" id="weight" step="0.01" value="8.1"
                            class="flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none text-base sm:text-lg">
                        <select id="weight-unit" onchange="convertWeight()" class="p-3 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-blue-500 outline-none text-sm sm:text-base min-w-[70px]">
                            <option value="oz">oz</option>
                            <option value="g">g</option>
                        </select>
                    </div>
                </div>

                <!-- Input: Balance Point -->
                <div class="mb-5 sm:mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">밸런스 포인트 (cm)</label>
                    <input type="number" id="balance" step="0.1" value="24.2"
                        class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none text-base sm:text-lg">
                    <p class="text-gray-500 text-xs sm:text-sm mt-2">
                        ℹ️ 버트캡 끝에서부터 패들이 균형을 이루는 지점까지의 거리
                    </p>
                </div>

                <!-- Input: Length -->
                <div class="mb-6 sm:mb-8">
                    <label class="block text-sm font-medium text-gray-700 mb-2">패들 길이</label>
                    <div class="flex gap-2">
                        <input type="number" id="length" step="0.01" value="16.5"
                            class="flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none text-base sm:text-lg">
                        <select id="length-unit" onchange="convertLength()" class="p-3 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-blue-500 outline-none text-sm sm:text-base min-w-[70px]">
                            <option value="in">in</option>
                            <option value="cm">cm</option>
                        </select>
                    </div>
                </div>

                <!-- Calculate Button -->
                <button onclick="calculate()"
                    class="w-full bg-yellow-400 hover:bg-yellow-500 active:bg-yellow-600 text-gray-900 font-bold py-3 sm:py-4 rounded-xl transition-colors shadow-md text-base sm:text-lg">
                    🔢 스윙 웨이트 계산
                </button>

                <!-- Result Box -->
                <div id="result-box" class="hidden mt-5 sm:mt-6 bg-yellow-100 border border-yellow-300 rounded-xl p-4 sm:p-5">
                    <p class="text-gray-600 text-sm mb-2">예상 스윙 웨이트</p>
                    <div class="flex items-baseline gap-2 mb-4">
                        <span id="result-value" class="text-4xl sm:text-5xl font-black text-gray-900">0</span>
                        <span class="text-gray-600 text-lg">kg·cm²</span>
                    </div>

                    <!-- Gauge Bar -->
                    <div class="mb-2">
                        <div class="h-3 bg-gray-200 rounded-full overflow-hidden">
                            <div id="gauge-bar" class="h-full bg-gradient-to-r from-green-400 via-yellow-400 to-red-500 transition-all duration-500" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="flex justify-between text-xs text-gray-500">
                        <span>낮음 (기동성)</span>
                        <span>높음 (파워)</span>
                    </div>
                </div>

                <!-- Disclaimer -->
                <p class="text-gray-400 text-xs mt-3 sm:mt-4">
                    *회귀 분석 공식 기반 추정값입니다. 정확도 약 97%
                </p>
            </div>

            <!-- Right: How it Works -->
            <div class="bg-white rounded-2xl border border-gray-200 shadow-sm p-5 sm:p-8">
                <h2 class="text-2xl sm:text-3xl font-extrabold text-gray-800 mb-4 sm:mb-6">계산 원리</h2>

                <p class="text-gray-600 leading-relaxed mb-3 sm:mb-4 text-sm sm:text-base">
                    이 계산기는 실제 피클볼 패들의 실험 데이터를 기반으로 한 다변량 회귀 모델을 사용합니다. 정적 무게, 밸런스 포인트, 전체 길이가 어떻게 조합되어 스윙 웨이트를 결정하는지 분석합니다.
                </p>

                <p class="text-gray-600 leading-relaxed mb-4 sm:mb-6 text-sm sm:text-base">
                    편의를 위해 무게는 <strong>oz</strong> 또는 <strong>g</strong>, 길이는 <strong>in</strong> 또는 <strong>cm</strong> 단위로 입력할 수 있으며, 내부적으로 변환됩니다.
                </p>

                <ul class="space-y-2 sm:space-y-3">
                    <li class="flex items-start gap-2">
                        <span class="text-gray-400">•</span>
                        <span class="text-gray-700 text-sm sm:text-base"><strong>높은 스윙 웨이트</strong> → 강한 파워와 밀어치기 능력</span>
                    </li>
                    <li class="flex items-start gap-2">
                        <span class="text-gray-400">•</span>
                        <span class="text-gray-700 text-sm sm:text-base"><strong>낮은 스윙 웨이트</strong> → 빠른 기동성과 조작성</span>
                    </li>
                    <li class="flex items-start gap-2">
                        <span class="text-gray-400">•</span>
                        <span class="text-gray-700 text-sm sm:text-base">패들 개조, 테이프 부착 등의 효과를 비교할 때 유용합니다.</span>
                    </li>
                </ul>
            </div>

        </div>

        <!-- Lead Tape Simulator Section -->
        <div class="mt-8 sm:mt-12">
            <div class="mb-4 sm:mb-6">
                <h2 class="text-xl sm:text-2xl font-bold text-gray-800">🎯 납테이프 시뮬레이터</h2>
                <p class="text-gray-500 text-sm sm:text-base">납테이프를 붙였을 때 무게, 밸런스 포인트, 스윙 웨이트 변화를 계산합니다.</p>
            </div>

            <div class="grid lg:grid-cols-2 gap-6 sm:gap-8">

                <!-- Left: Lead Tape Input -->
                <div class="bg-white rounded-2xl border border-gray-200 shadow-sm p-5 sm:p-8">
                    <h3 class="text-base sm:text-lg font-bold text-gray-800 mb-4 sm:mb-6">납테이프 설정</h3>

                    <!-- Lead Tape Weight -->
                    <div class="mb-5 sm:mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2">납테이프 무게</label>
                        <div class="flex gap-2">
                            <input type="number" id="tape-weight" step="0.1" value="5"
                                class="flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none text-base sm:text-lg">
                            <span class="p-3 bg-gray-100 border border-gray-300 rounded-lg text-gray-600 min-w-[70px] text-center">g</span>
                        </div>
                    </div>

                    <!-- Lead Tape Position -->
                    <div class="mb-6 sm:mb-8">
                        <label class="block text-sm font-medium text-gray-700 mb-2">부착 위치 (패들 상단에서)</label>
                        <div class="flex gap-2">
                            <input type="number" id="tape-position" step="0.1" value="3"
                                class="flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none text-base sm:text-lg">
                            <span class="p-3 bg-gray-100 border border-gray-300 rounded-lg text-gray-600 min-w-[70px] text-center">cm</span>
                        </div>
                        <p class="text-gray-500 text-xs sm:text-sm mt-2">
                            ℹ️ 패들 상단(헤드 끝)에서 납테이프 중심까지의 거리
                        </p>
                    </div>

                    <!-- Paddle Preview -->
                    <div class="bg-gray-50 rounded-xl p-4 mb-6">
                        <p class="text-sm font-medium text-gray-600 mb-3 text-center">패들 미리보기</p>
                        <div class="flex justify-center">
                            <div class="relative w-20 sm:w-24">
                                <!-- Paddle Shape -->
                                <div class="bg-gray-300 rounded-t-full w-full h-32 sm:h-40 relative border-2 border-gray-400">
                                    <!-- Lead Tape Indicator -->
                                    <div id="tape-indicator" class="absolute left-1 right-1 h-2 bg-red-500 rounded transition-all duration-300" style="top: 10%"></div>
                                    <!-- Top Label -->
                                    <div class="absolute -top-6 left-1/2 transform -translate-x-1/2 text-xs text-gray-500">상단</div>
                                </div>
                                <!-- Handle -->
                                <div class="bg-gray-400 w-8 sm:w-10 h-12 sm:h-14 mx-auto rounded-b-lg border-2 border-t-0 border-gray-500"></div>
                                <!-- Bottom Label -->
                                <div class="text-xs text-gray-500 text-center mt-1">버트캡</div>
                            </div>
                        </div>
                    </div>

                    <!-- Calculate Button -->
                    <button onclick="calculateWithTape()"
                        class="w-full bg-blue-500 hover:bg-blue-600 active:bg-blue-700 text-white font-bold py-3 sm:py-4 rounded-xl transition-colors shadow-md text-base sm:text-lg">
                        🧮 변화량 계산
                    </button>
                </div>

                <!-- Right: Comparison Result -->
                <div class="bg-white rounded-2xl border border-gray-200 shadow-sm p-5 sm:p-8">
                    <h3 class="text-base sm:text-lg font-bold text-gray-800 mb-4 sm:mb-6">📊 변화 비교</h3>

                    <!-- Comparison Table -->
                    <div id="tape-result" class="hidden">
                        <div class="overflow-x-auto mb-6">
                            <table class="w-full text-sm sm:text-base">
                                <thead>
                                    <tr class="border-b-2 border-gray-200">
                                        <th class="text-left py-2 text-gray-600 font-medium"></th>
                                        <th class="text-center py-2 text-gray-600 font-medium">기존</th>
                                        <th class="text-center py-2 text-gray-600 font-medium">변경</th>
                                        <th class="text-center py-2 text-gray-600 font-medium">변화</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="border-b border-gray-100">
                                        <td class="py-3 text-gray-700 font-medium">무게</td>
                                        <td class="py-3 text-center text-gray-600"><span id="orig-weight">-</span></td>
                                        <td class="py-3 text-center text-gray-900 font-semibold"><span id="new-weight">-</span></td>
                                        <td class="py-3 text-center text-blue-600 font-semibold"><span id="diff-weight">-</span></td>
                                    </tr>
                                    <tr class="border-b border-gray-100">
                                        <td class="py-3 text-gray-700 font-medium">밸런스</td>
                                        <td class="py-3 text-center text-gray-600"><span id="orig-balance">-</span></td>
                                        <td class="py-3 text-center text-gray-900 font-semibold"><span id="new-balance">-</span></td>
                                        <td class="py-3 text-center text-blue-600 font-semibold"><span id="diff-balance">-</span></td>
                                    </tr>
                                    <tr>
                                        <td class="py-3 text-gray-700 font-medium">스윙웨이트</td>
                                        <td class="py-3 text-center text-gray-600"><span id="orig-sw">-</span></td>
                                        <td class="py-3 text-center text-gray-900 font-semibold"><span id="new-sw">-</span></td>
                                        <td class="py-3 text-center text-blue-600 font-semibold"><span id="diff-sw">-</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Dual Gauge Bars -->
                        <div class="space-y-4">
                            <p class="text-sm font-medium text-gray-600">스윙 웨이트 변화</p>

                            <!-- Original -->
                            <div>
                                <div class="flex justify-between text-xs text-gray-500 mb-1">
                                    <span>기존</span>
                                    <span id="orig-sw-label">-</span>
                                </div>
                                <div class="h-3 bg-gray-200 rounded-full overflow-hidden">
                                    <div id="orig-gauge" class="h-full bg-gray-400 transition-all duration-500" style="width: 0%"></div>
                                </div>
                            </div>

                            <!-- New -->
                            <div>
                                <div class="flex justify-between text-xs text-gray-500 mb-1">
                                    <span>변경</span>
                                    <span id="new-sw-label">-</span>
                                </div>
                                <div class="h-3 bg-gray-200 rounded-full overflow-hidden">
                                    <div id="new-gauge" class="h-full bg-gradient-to-r from-green-400 via-yellow-400 to-red-500 transition-all duration-500" style="width: 0%"></div>
                                </div>
                            </div>

                            <div class="flex justify-between text-xs text-gray-400 mt-1">
                                <span>낮음 (기동성)</span>
                                <span>높음 (파워)</span>
                            </div>
                        </div>
                    </div>

                    <!-- Empty State -->
                    <div id="tape-empty" class="text-center py-12 text-gray-400">
                        <p class="text-4xl mb-3">📊</p>
                        <p class="text-sm">납테이프 설정 후<br>"변화량 계산" 버튼을 눌러주세요</p>
                    </div>
                </div>

            </div>
        </div>

        <!-- FAQ Section -->
        <div class="mt-8 sm:mt-12">
            <h2 class="text-xl sm:text-2xl font-bold text-gray-800 mb-4 sm:mb-6">자주 묻는 질문</h2>

            <div class="space-y-3">
                <!-- FAQ 1 -->
                <div class="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
                    <button onclick="toggleFaq(this)" class="w-full p-4 sm:p-5 text-left flex justify-between items-center hover:bg-gray-50 transition-colors">
                        <span class="font-semibold text-gray-800 text-sm sm:text-base">❓ 스윙 웨이트란 무엇인가요?</span>
                        <span class="faq-icon text-gray-400 text-xl transition-transform">+</span>
                    </button>
                    <div class="faq-content">
                        <div class="px-4 sm:px-5 pb-4 sm:pb-5 text-gray-600 text-sm sm:text-base leading-relaxed">
                            스윙 웨이트는 패들을 스윙할 때 느껴지는 무게감을 나타냅니다. 정적 무게가 같은 두 패들이라도 무게 분포가 다르면 스윙 시 전혀 다른 느낌을 줄 수 있습니다. 헤드 쪽에 무게가 집중되면 스윙 웨이트가 높아지고, 그립 쪽에 집중되면 낮아집니다.
                        </div>
                    </div>
                </div>

                <!-- FAQ 2 -->
                <div class="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
                    <button onclick="toggleFaq(this)" class="w-full p-4 sm:p-5 text-left flex justify-between items-center hover:bg-gray-50 transition-colors">
                        <span class="font-semibold text-gray-800 text-sm sm:text-base">❓ 얼마나 정확한가요?</span>
                        <span class="faq-icon text-gray-400 text-xl transition-transform">+</span>
                    </button>
                    <div class="faq-content">
                        <div class="px-4 sm:px-5 pb-4 sm:pb-5 text-gray-600 text-sm sm:text-base leading-relaxed">
                            물리 법칙을 이용한 이론적인 계산이고, 밸런스 포인트 측정 시 오차가 있을 수 있어서 어느 정도 오차가 있을 수 있습니다. 데이터가 쌓이면 오차를 줄여나갈 것입니다. 참고로만 활용하길 바랍니다.
                        </div>
                    </div>
                </div>

                <!-- FAQ 3 -->
                <div class="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
                    <button onclick="toggleFaq(this)" class="w-full p-4 sm:p-5 text-left flex justify-between items-center hover:bg-gray-50 transition-colors">
                        <span class="font-semibold text-gray-800 text-sm sm:text-base">❓ 밸런스 포인트는 어떻게 측정하나요?</span>
                        <span class="faq-icon text-gray-400 text-xl transition-transform">+</span>
                    </button>
                    <div class="faq-content">
                        <div class="px-4 sm:px-5 pb-4 sm:pb-5 text-gray-600 text-sm sm:text-base leading-relaxed">
                            패들을 얇은 막대나 손가락 위에 올려 균형이 잡히는 지점을 찾습니다. 버트캡 끝에서 그 균형점까지의 거리를 cm로 측정하면 됩니다. 일반적으로 피클볼 패들의 밸런스 포인트는 23~25cm 범위입니다.
                        </div>
                    </div>
                </div>

                <!-- FAQ 4 - Lead Tape -->
                <div class="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
                    <button onclick="toggleFaq(this)" class="w-full p-4 sm:p-5 text-left flex justify-between items-center hover:bg-gray-50 transition-colors">
                        <span class="font-semibold text-gray-800 text-sm sm:text-base">❓ 납테이프는 어디에 붙여야 하나요?</span>
                        <span class="faq-icon text-gray-400 text-xl transition-transform">+</span>
                    </button>
                    <div class="faq-content">
                        <div class="px-4 sm:px-5 pb-4 sm:pb-5 text-gray-600 text-sm sm:text-base leading-relaxed">
                            <strong>파워를 높이려면</strong> 패들 상단(헤드)에 붙이세요. 스윙 웨이트가 증가합니다.
                            <strong>기동성을 높이려면</strong> 그립 근처에 붙이세요. 무게는 늘지만 스윙 웨이트 증가가 적습니다.
                            일반적으로 3~10g 정도가 적당하며, 너무 많이 붙이면 팔에 무리가 갈 수 있습니다.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="mt-8 sm:mt-12 text-center text-gray-400 text-xs sm:text-sm">
            <p>*회귀 분석 공식 기반 추정값입니다. 정확도 약 97%</p>
        </div>

    </div>

    <script>
        // 패들 프리셋 데이터
        const paddlePresets = {
            joola: { weight: 8.1, balance: 24.2, length: 16.5, weightUnit: 'oz', lengthUnit: 'in' },
            selkirk: { weight: 7.9, balance: 24.5, length: 16.5, weightUnit: 'oz', lengthUnit: 'in' },
            crbn: { weight: 8.0, balance: 24.0, length: 16.5, weightUnit: 'oz', lengthUnit: 'in' },
            engage: { weight: 8.2, balance: 23.8, length: 16.0, weightUnit: 'oz', lengthUnit: 'in' },
            franklin: { weight: 8.0, balance: 24.1, length: 16.5, weightUnit: 'oz', lengthUnit: 'in' }
        };

        // 이전 단위 저장
        let prevWeightUnit = 'oz';
        let prevLengthUnit = 'in';

        // 마지막 계산 결과 저장 (납테이프 계산용)
        let lastCalculation = {
            weightG: 0,
            balanceCm: 0,
            lengthCm: 0,
            swingWeight: 0
        };

        // 프리셋 적용
        function applyPreset() {
            const presetSelect = document.getElementById('paddle-preset');
            const preset = paddlePresets[presetSelect.value];

            if (preset) {
                document.getElementById('weight-unit').value = preset.weightUnit;
                document.getElementById('length-unit').value = preset.lengthUnit;
                prevWeightUnit = preset.weightUnit;
                prevLengthUnit = preset.lengthUnit;

                document.getElementById('weight').value = preset.weight;
                document.getElementById('balance').value = preset.balance;
                document.getElementById('length').value = preset.length;

                calculate();
            }
        }

        // 무게 단위 변환
        function convertWeight() {
            const weightInput = document.getElementById('weight');
            const weightUnit = document.getElementById('weight-unit').value;
            const currentValue = parseFloat(weightInput.value);

            if (!isNaN(currentValue) && currentValue > 0) {
                let newValue;
                if (prevWeightUnit === 'oz' && weightUnit === 'g') {
                    newValue = currentValue * 28.3495;
                } else if (prevWeightUnit === 'g' && weightUnit === 'oz') {
                    newValue = currentValue / 28.3495;
                } else {
                    newValue = currentValue;
                }
                weightInput.value = newValue.toFixed(2);
            }
            prevWeightUnit = weightUnit;
        }

        // 길이 단위 변환
        function convertLength() {
            const lengthInput = document.getElementById('length');
            const lengthUnit = document.getElementById('length-unit').value;
            const currentValue = parseFloat(lengthInput.value);

            if (!isNaN(currentValue) && currentValue > 0) {
                let newValue;
                if (prevLengthUnit === 'in' && lengthUnit === 'cm') {
                    newValue = currentValue * 2.54;
                } else if (prevLengthUnit === 'cm' && lengthUnit === 'in') {
                    newValue = currentValue / 2.54;
                } else {
                    newValue = currentValue;
                }
                lengthInput.value = newValue.toFixed(2);
            }
            prevLengthUnit = lengthUnit;
        }

        // 스윙 웨이트 계산 함수 (내부용)
        function calculateSwingWeight(weightKg, balanceCm, lengthCm) {
            const PIVOT_OFFSET = 10;
            const SHAPE_FACTOR = 5.5;

            const rotationalTerm = weightKg * Math.pow(balanceCm - PIVOT_OFFSET, 2);
            const inertiaTerm = (weightKg * Math.pow(lengthCm, 2)) / SHAPE_FACTOR;

            return rotationalTerm + inertiaTerm;
        }

        function calculate() {
            const weightInput = parseFloat(document.getElementById('weight').value);
            const balanceCm = parseFloat(document.getElementById('balance').value);
            const lengthInput = parseFloat(document.getElementById('length').value);

            const weightUnit = document.getElementById('weight-unit').value;
            const lengthUnit = document.getElementById('length-unit').value;

            if (isNaN(weightInput) || isNaN(balanceCm) || isNaN(lengthInput)) {
                alert("모든 값을 정확히 입력해주세요.");
                return;
            }

            // 단위 변환
            let weightG;
            if (weightUnit === 'oz') {
                weightG = weightInput * 28.3495;
            } else {
                weightG = weightInput;
            }

            let lengthCm;
            if (lengthUnit === 'in') {
                lengthCm = lengthInput * 2.54;
            } else {
                lengthCm = lengthInput;
            }

            const weightKg = weightG / 1000;
            const swingWeight = calculateSwingWeight(weightKg, balanceCm, lengthCm);

            // 결과 저장 (납테이프 계산용)
            lastCalculation = {
                weightG: weightG,
                balanceCm: balanceCm,
                lengthCm: lengthCm,
                swingWeight: swingWeight
            };

            // 결과 표시
            const resultBox = document.getElementById('result-box');
            const resultValue = document.getElementById('result-value');
            const gaugeBar = document.getElementById('gauge-bar');

            resultBox.classList.remove('hidden');
            resultValue.textContent = swingWeight.toFixed(1);

            // 게이지 바 업데이트
            const minSW = 90;
            const maxSW = 140;
            const percentage = Math.min(100, Math.max(0, ((swingWeight - minSW) / (maxSW - minSW)) * 100));
            gaugeBar.style.width = percentage + '%';

            // 납테이프 결과 초기화
            document.getElementById('tape-result').classList.add('hidden');
            document.getElementById('tape-empty').classList.remove('hidden');
        }

        // 납테이프 계산
        function calculateWithTape() {
            if (lastCalculation.weightG === 0) {
                alert("먼저 메인 계산기에서 패들 스펙을 계산해주세요.");
                return;
            }

            const tapeWeight = parseFloat(document.getElementById('tape-weight').value);
            const tapePosition = parseFloat(document.getElementById('tape-position').value);

            if (isNaN(tapeWeight) || isNaN(tapePosition)) {
                alert("납테이프 무게와 위치를 입력해주세요.");
                return;
            }

            if (tapePosition > lastCalculation.lengthCm) {
                alert("부착 위치가 패들 길이보다 클 수 없습니다.");
                return;
            }

            // 기존 값
            const origWeightG = lastCalculation.weightG;
            const origBalanceCm = lastCalculation.balanceCm;
            const origLengthCm = lastCalculation.lengthCm;
            const origSW = lastCalculation.swingWeight;

            // 새 값 계산
            // 납테이프 위치 (버트캡 기준) = 패들길이 - 상단에서의 거리
            const tapePositionFromButt = origLengthCm - tapePosition;

            // 새 무게
            const newWeightG = origWeightG + tapeWeight;

            // 새 밸런스 포인트 (무게중심 공식)
            const newBalanceCm = (origWeightG * origBalanceCm + tapeWeight * tapePositionFromButt) / newWeightG;

            // 새 스윙 웨이트
            const newWeightKg = newWeightG / 1000;
            const newSW = calculateSwingWeight(newWeightKg, newBalanceCm, origLengthCm);

            // 변화량
            const diffWeight = tapeWeight;
            const diffBalance = newBalanceCm - origBalanceCm;
            const diffSW = newSW - origSW;

            // 결과 표시
            document.getElementById('tape-result').classList.remove('hidden');
            document.getElementById('tape-empty').classList.add('hidden');

            // 테이블 업데이트
            document.getElementById('orig-weight').textContent = origWeightG.toFixed(1) + 'g';
            document.getElementById('new-weight').textContent = newWeightG.toFixed(1) + 'g';
            document.getElementById('diff-weight').textContent = '+' + diffWeight.toFixed(1) + 'g';

            document.getElementById('orig-balance').textContent = origBalanceCm.toFixed(2) + 'cm';
            document.getElementById('new-balance').textContent = newBalanceCm.toFixed(2) + 'cm';
            document.getElementById('diff-balance').textContent = (diffBalance >= 0 ? '+' : '') + diffBalance.toFixed(2) + 'cm';

            document.getElementById('orig-sw').textContent = origSW.toFixed(1);
            document.getElementById('new-sw').textContent = newSW.toFixed(1);
            document.getElementById('diff-sw').textContent = (diffSW >= 0 ? '+' : '') + diffSW.toFixed(1);

            // 게이지 바 업데이트
            const minSW = 90;
            const maxSW = 140;
            const origPercentage = Math.min(100, Math.max(0, ((origSW - minSW) / (maxSW - minSW)) * 100));
            const newPercentage = Math.min(100, Math.max(0, ((newSW - minSW) / (maxSW - minSW)) * 100));

            document.getElementById('orig-gauge').style.width = origPercentage + '%';
            document.getElementById('new-gauge').style.width = newPercentage + '%';
            document.getElementById('orig-sw-label').textContent = origSW.toFixed(1);
            document.getElementById('new-sw-label').textContent = newSW.toFixed(1) + ' (' + (diffSW >= 0 ? '+' : '') + diffSW.toFixed(1) + ')';

            // 패들 미리보기 업데이트
            updateTapeIndicator(tapePosition, origLengthCm);
        }

        // 패들 미리보기에서 납테이프 위치 업데이트
        function updateTapeIndicator(tapePosition, lengthCm) {
            const indicator = document.getElementById('tape-indicator');
            // 패들 헤드 영역 (전체의 약 75%)에서의 위치 계산
            const headHeight = 75; // 퍼센트
            const positionPercent = (tapePosition / lengthCm) * headHeight;
            indicator.style.top = Math.min(positionPercent, 70) + '%';
        }

        // 납테이프 위치 입력 시 미리보기 업데이트
        document.getElementById('tape-position').addEventListener('input', function() {
            const tapePosition = parseFloat(this.value) || 0;
            const lengthCm = lastCalculation.lengthCm || 42;
            updateTapeIndicator(tapePosition, lengthCm);
        });

        // FAQ 토글
        function toggleFaq(button) {
            const content = button.nextElementSibling;
            const icon = button.querySelector('.faq-icon');

            content.classList.toggle('open');
            icon.textContent = content.classList.contains('open') ? '−' : '+';
        }

        // 페이지 로드 시 자동 계산
        document.addEventListener('DOMContentLoaded', function() {
            calculate();
        });
    </script>
</body>
</html>
